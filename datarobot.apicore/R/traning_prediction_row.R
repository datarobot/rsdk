# Copyright 2021-2022 DataRobot, Inc. and its affiliates.
#
# All rights reserved.
#
# DataRobot, Inc.
#
# This is proprietary source code of DataRobot, Inc. and its
# affiliates.

# Public API
#
# DataRobot's Public facing API
#
# The version of the OpenAPI document: 2.29.0
# Contact: api-maintainer@datarobot.com
# Generated by: https://openapi-generator.tech

#' @docType class
#' @title TraningPredictionRow
#'
#' @description TraningPredictionRow Class
#'
#' @format An \code{R6Class} generator object
#'
#' @field forecastDistance  integer [optional] (if time series project) The number of time units this prediction is away from the forecastPoint. The unit of time is determined by the timeUnit of the datetime partition column.
#'
#' @field forecastPoint  character [optional] (if time series project) The forecastPoint of the predictions. Either provided or inferred.
#'
#' @field partitionId  character The partition used for the prediction record
#'
#' @field prediction  \link{OneOfnumberstringarray} The prediction of the model.
#'
#' @field predictionExplanations  list( \link{PredictionExplanationsObject} ) [optional] Array contains &#x60;predictionExplanation&#x60; objects. The total elements in the array are bounded by maxExplanations and feature count. It will be present only if &#x60;explanationAlgorithm&#x60; is not null (prediction explanations were requested).
#'
#' @field predictionThreshold  numeric [optional] Threshold used for binary classification in predictions.
#'
#' @field predictionValues  list( \link{PredictionArrayObjectValues} ) [optional] A list of predicted values for this row.
#'
#' @field rowId  integer The row in the prediction dataset this prediction corresponds to.
#'
#' @field seriesId  character [optional] The ID of the series value for a multiseries project. For time series projects that are not a multiseries this will be a NaN.
#'
#' @field shapMetadata  \link{TraningPredictionShapMetadata} [optional]
#'
#' @field timestamp  character [optional] (if time series project) The timestamp of this row in the prediction dataset.
#'
#' @importFrom R6 R6Class
#' @importFrom jsonlite fromJSON toJSON
#' @export
TraningPredictionRow <- R6::R6Class(
  "TraningPredictionRow",
  lock_objects = FALSE,
  private = list(
    # @description The properties of this object that are required to be set.
    # @description A helper function to handle assist with type validation. This function will validate class parameters with definite
    # types assigned to them, as well as handling validation of parameters with anyOf and oneOf types listed. These types
    # can themselves be other R6 objects.
    validateProps = function(`forecastDistance` = NULL, `forecastPoint` = NULL, `partitionId` = NULL, `prediction` = NULL, `predictionExplanations` = NULL, `predictionThreshold` = NULL, `predictionValues` = NULL, `rowId` = NULL, `seriesId` = NULL, `shapMetadata` = NULL, `timestamp` = NULL) {
      if (!is.null(`partitionId`)) {
        stopifnot(is.character(`partitionId`), length(`partitionId`) == 1)
      }
      if (!is.null(`prediction`)) {
        .setPrimitiveProperty(typeList = list("numeric", "character", "array"), propertyData = prediction)
      }
      if (!is.null(`rowId`)) {
        stopifnot(is.numeric(`rowId`), length(`rowId`) == 1)
      }
      if (!is.null(`forecastDistance`)) {
        stopifnot(is.numeric(`forecastDistance`), length(`forecastDistance`) == 1)
      }
      if (!is.null(`forecastPoint`)) {
        stopifnot(inherits(`forecastPoint`, "POSIXt"))
      }
      if (!is.null(`predictionExplanations`) && length(`predictionExplanations`) > 0) {
        stopifnot(is.vector(`predictionExplanations`), sapply(`predictionExplanations`, R6::is.R6))
      }
      if (!is.null(`predictionThreshold`)) {
        stopifnot(is.numeric(`predictionThreshold`), length(`predictionThreshold`) == 1)
      }
      if (!is.null(`predictionValues`) && length(`predictionValues`) > 0) {
        stopifnot(is.vector(`predictionValues`), sapply(`predictionValues`, R6::is.R6))
      }
      if (!is.null(`seriesId`)) {
        stopifnot(is.character(`seriesId`), length(`seriesId`) == 1)
      }
      if (!is.null(`shapMetadata`)) {
        stopifnot(R6::is.R6(`shapMetadata`))
      }
      if (!is.null(`timestamp`)) {
        stopifnot(inherits(`timestamp`, "POSIXt"))
      }
    }
  ),
  public = list(
    `forecastDistance` = NULL,
    `forecastPoint` = NULL,
    `partitionId` = NULL,
    `prediction` = NULL,
    `predictionExplanations` = NULL,
    `predictionThreshold` = NULL,
    `predictionValues` = NULL,
    `rowId` = NULL,
    `seriesId` = NULL,
    `shapMetadata` = NULL,
    `timestamp` = NULL,
    #' @description A function used to initialize an instance of this class.
    #' @param forecastDistance (if time series project) The number of time units this prediction is away from the forecastPoint. The unit of time is determined by the timeUnit of the datetime partition column.
    #' @param forecastPoint (if time series project) The forecastPoint of the predictions. Either provided or inferred.
    #' @param partitionId The partition used for the prediction record
    #' @param prediction The prediction of the model.
    #' @param predictionExplanations Array contains &#x60;predictionExplanation&#x60; objects. The total elements in the array are bounded by maxExplanations and feature count. It will be present only if &#x60;explanationAlgorithm&#x60; is not null (prediction explanations were requested).
    #' @param predictionThreshold Threshold used for binary classification in predictions.
    #' @param predictionValues A list of predicted values for this row.
    #' @param rowId The row in the prediction dataset this prediction corresponds to.
    #' @param seriesId The ID of the series value for a multiseries project. For time series projects that are not a multiseries this will be a NaN.
    #' @param shapMetadata
    #' @param timestamp (if time series project) The timestamp of this row in the prediction dataset.
    #' @param validateParams An optional param for auto validating this object's parameters before initialization. Default FALSE.
    #' @param ... Any additional keyword arguments to be passed into this object for initialization.
    initialize = function(`partitionId` = NULL, `prediction` = NULL, `rowId` = NULL, `forecastDistance` = NULL, `forecastPoint` = NULL, `predictionExplanations` = NULL, `predictionThreshold` = NULL, `predictionValues` = NULL, `seriesId` = NULL, `shapMetadata` = NULL, `timestamp` = NULL, validateParams = FALSE, ...) {
      local.optional.var <- list(...)
      if (validateParams) {
        lapply(list(`partitionId`, `prediction`, `rowId`), function(param) {
          stopifnot("Required param not set." = !is.null(param))
        })
        private$validateProps(forecastDistance, forecastPoint, partitionId, prediction, predictionExplanations, predictionThreshold, predictionValues, rowId, seriesId, shapMetadata, timestamp)
      }
      self$`forecastDistance` <- `forecastDistance`
      self$`forecastPoint` <- `forecastPoint`
      self$`partitionId` <- `partitionId`
      self$`prediction` <- .setPrimitiveProperty(typeList = list("numeric", "character", "array"), propertyData = prediction)
      self$`predictionExplanations` <- `predictionExplanations`
      self$`predictionThreshold` <- `predictionThreshold`
      self$`predictionValues` <- `predictionValues`
      self$`rowId` <- `rowId`
      self$`seriesId` <- `seriesId`
      self$`shapMetadata` <- `shapMetadata`
      self$`timestamp` <- `timestamp`
    },
    #' @description A helper function that provides public access to the private validateProps function. This allows users the ability
    #' to programmatically validate objects before sending them to DataRobot.
    #' checking this objects set properties.
    validate = function() {
      do.call(private$validateProps, list(forecastDistance = self$`forecastDistance`, forecastPoint = self$`forecastPoint`, partitionId = self$`partitionId`, prediction = self$`prediction`, predictionExplanations = self$`predictionExplanations`, predictionThreshold = self$`predictionThreshold`, predictionValues = self$`predictionValues`, rowId = self$`rowId`, seriesId = self$`seriesId`, shapMetadata = self$`shapMetadata`, timestamp = self$`timestamp`))
    },
    #' @description A helper function that serializes this object into a JSON encoded string.
    toJSON = function() {
      jsoncontent <- c(
        if (!is.null(self$`forecastDistance`)) {
          sprintf(
            '"forecastDistance":
            %d
                  ',
            self$`forecastDistance`
          )
        },
        if (!is.null(self$`forecastPoint`)) {
          sprintf(
            '"forecastPoint":
            "%s"
                  ',
            format(self$`forecastPoint`, format = "%Y-%m-%dT%H:%M:%OSZ", tz = "UTC")
          )
        },
        if (!is.null(self$`partitionId`)) {
          sprintf(
            '"partitionId":
            "%s"
                  ',
            self$`partitionId`
          )
        },
        if (!is.null(self$`prediction`)) {
          sprintf(
            '"prediction":
            %s
      ',
            self$`prediction`
          )
        },
        if (!is.null(self$`predictionExplanations`)) {
          sprintf(
            '"predictionExplanations":
            [%s]
      ',
            paste(sapply(self$`predictionExplanations`, function(x) jsonlite::toJSON(x$toJSON(), auto_unbox = TRUE, digits = NA)), collapse = ",")
          )
        },
        if (!is.null(self$`predictionThreshold`)) {
          sprintf(
            '"predictionThreshold":
            %d
                  ',
            self$`predictionThreshold`
          )
        },
        if (!is.null(self$`predictionValues`)) {
          sprintf(
            '"predictionValues":
            [%s]
      ',
            paste(sapply(self$`predictionValues`, function(x) jsonlite::toJSON(x$toJSON(), auto_unbox = TRUE, digits = NA)), collapse = ",")
          )
        },
        if (!is.null(self$`rowId`)) {
          sprintf(
            '"rowId":
            %d
                  ',
            self$`rowId`
          )
        },
        if (!is.null(self$`seriesId`)) {
          sprintf(
            '"seriesId":
            "%s"
                  ',
            self$`seriesId`
          )
        },
        if (!is.null(self$`shapMetadata`)) {
          sprintf(
            '"shapMetadata":
            %s
      ',
            jsonlite::toJSON(self$`shapMetadata`$toJSON(), auto_unbox = TRUE, digits = NA)
          )
        },
        if (!is.null(self$`timestamp`)) {
          sprintf(
            '"timestamp":
            "%s"
                  ',
            format(self$`timestamp`, format = "%Y-%m-%dT%H:%M:%OSZ", tz = "UTC")
          )
        }
      )
      jsoncontent <- paste(jsoncontent, collapse = ",")
      paste("{", jsoncontent, "}", sep = "")
    },
    #' @description A helper function that deserializes a JSON string into an instance of this class.
    #' @param TraningPredictionRowJson A JSON encoded string representation of a class instance.
    #' @param validateParams An optional param for auto validating this object's parameters after deserialization. Default FALSE.
    fromJSON = function(TraningPredictionRowJson, validateParams = FALSE) {
      TraningPredictionRowObject <- jsonlite::fromJSON(TraningPredictionRowJson)
      self$`forecastDistance` <- TraningPredictionRowObject$`forecastDistance`
      self$`forecastPoint` <- ParseRFC3339Timestamp(TraningPredictionRowObject$`forecastPoint`)
      self$`partitionId` <- TraningPredictionRowObject$`partitionId`
      self$`prediction` <- .setPrimitiveProperty(typeList = list("numeric", "character", "array"), propertyData = TraningPredictionRowObject$prediction)
      self$`predictionExplanations` <- ApiClient$new()$deserializeObj(TraningPredictionRowObject$`predictionExplanations`, "array[PredictionExplanationsObject]", loadNamespace("datarobot.apicore"))
      self$`predictionThreshold` <- TraningPredictionRowObject$`predictionThreshold`
      self$`predictionValues` <- ApiClient$new()$deserializeObj(TraningPredictionRowObject$`predictionValues`, "array[PredictionArrayObjectValues]", loadNamespace("datarobot.apicore"))
      self$`rowId` <- TraningPredictionRowObject$`rowId`
      self$`seriesId` <- TraningPredictionRowObject$`seriesId`
      self$`shapMetadata` <- TraningPredictionShapMetadata$new()$fromJSON(jsonlite::toJSON(TraningPredictionRowObject$shapMetadata, auto_unbox = TRUE, digits = NA, null = "null"))
      self$`timestamp` <- ParseRFC3339Timestamp(TraningPredictionRowObject$`timestamp`)

      if (validateParams) {
        self$validate()
      }

      return(self)
    }
  )
)
