# Copyright 2021-2022 DataRobot, Inc. and its affiliates.
#
# All rights reserved.
#
# DataRobot, Inc.
#
# This is proprietary source code of DataRobot, Inc. and its
# affiliates.

# Public API
#
# DataRobot's Public facing API
#
# The version of the OpenAPI document: 2.29.0
# Contact: api-maintainer@datarobot.com
# Generated by: https://openapi-generator.tech

#' @docType class
#' @title PredictionProxyData
#'
#' @description PredictionProxyData Class
#'
#' @format An \code{R6Class} generator object
#'
#' @field deploymentApprovalStatus  \link{OneOfstringstring} [optional] The approval status of the deployment.
#'
#' @field forecastDistance  integer [optional] In the case of time series project, the number of time units this row is away from the forecastPoint. The unit of time is determined by the timeUnit of the datetime partition column.
#'
#' @field forecastPoint  character [optional] For time series projects only. The time in the dataset relative to which predictions were generated.
#'
#' @field isOutlierPrediction  character [optional] The outlier warning check result.
#'
#' @field passthroughValues  object [optional]
#'
#' @field prediction  \link{OneOfstringnumber} In the case of a regression, the value predicted for the target in that row. In the case of any classification type, the class of the target which the row is predicted to belong to.
#'
#' @field predictionExplanations  list( \link{PredictionExplanationsValues} ) [optional] Array contains &#x60;predictionExplanation&#x60; objects. Will be present only if &#x60;explanationAlgorithm&#x60; is not null (prediction explanations were requested).
#'
#' @field predictionIntervals  object [optional]
#'
#' @field predictionThreshold  numeric [optional] Threshold used for binary classification in predictions.
#'
#' @field predictionValues  list( \link{PredictionValues} ) Array of &#x60;predictionValue&#x60; objects for each class.
#'
#' @field rowId  integer The row in the prediction dataset this prediction corresponds to.
#'
#' @field seriesId  character [optional] The ID of the series value for a multiseries project. For time series projects that are not multiseries this will be a null.
#'
#' @field shapExplanationsMetadata  list( \link{ShapExplanationsMetadataValues} ) [optional] Array contains prediction explanation metadata.
#'
#' @field timestamp  character [optional] The timestamp of this row in the prediction dataset.
#'
#' @importFrom R6 R6Class
#' @importFrom jsonlite fromJSON toJSON
#' @export
PredictionProxyData <- R6::R6Class(
  "PredictionProxyData",
  lock_objects = FALSE,
  private = list(
    # @description The properties of this object that are required to be set.
    # @description A helper function to handle assist with type validation. This function will validate class parameters with definite
    # types assigned to them, as well as handling validation of parameters with anyOf and oneOf types listed. These types
    # can themselves be other R6 objects.
    validateProps = function(`deploymentApprovalStatus` = NULL, `forecastDistance` = NULL, `forecastPoint` = NULL, `isOutlierPrediction` = NULL, `passthroughValues` = NULL, `prediction` = NULL, `predictionExplanations` = NULL, `predictionIntervals` = NULL, `predictionThreshold` = NULL, `predictionValues` = NULL, `rowId` = NULL, `seriesId` = NULL, `shapExplanationsMetadata` = NULL, `timestamp` = NULL) {
      if (!is.null(`prediction`)) {
        .setPrimitiveProperty(typeList = list("character", "numeric"), propertyData = prediction)
      }
      if (!is.null(`predictionValues`)) {
        stopifnot(is.vector(`predictionValues`), sapply(`predictionValues`, R6::is.R6))
      }
      if (!is.null(`rowId`)) {
        stopifnot(is.numeric(`rowId`), length(`rowId`) == 1)
      }
      if (!is.null(`deploymentApprovalStatus`)) {
        .setPrimitiveProperty(typeList = list("character"), propertyData = deploymentApprovalStatus)
      }
      if (!is.null(`forecastDistance`)) {
        stopifnot(is.numeric(`forecastDistance`), length(`forecastDistance`) == 1)
      }
      if (!is.null(`forecastPoint`)) {
        stopifnot(inherits(`forecastPoint`, "POSIXt"))
      }
      if (!is.null(`isOutlierPrediction`)) {
        stopifnot(is.logical(`isOutlierPrediction`), length(`isOutlierPrediction`) == 1)
      }
      if (!is.null(`passthroughValues`)) {
      }
      if (!is.null(`predictionExplanations`) && length(`predictionExplanations`) > 0) {
        stopifnot(is.vector(`predictionExplanations`), sapply(`predictionExplanations`, R6::is.R6))
      }
      if (!is.null(`predictionIntervals`)) {
      }
      if (!is.null(`predictionThreshold`)) {
        stopifnot(is.numeric(`predictionThreshold`), length(`predictionThreshold`) == 1)
      }
      if (!is.null(`seriesId`)) {
        stopifnot(is.character(`seriesId`), length(`seriesId`) == 1)
      }
      if (!is.null(`shapExplanationsMetadata`) && length(`shapExplanationsMetadata`) > 0) {
        stopifnot(is.vector(`shapExplanationsMetadata`), sapply(`shapExplanationsMetadata`, R6::is.R6))
      }
      if (!is.null(`timestamp`)) {
        stopifnot(inherits(`timestamp`, "POSIXt"))
      }
    }
  ),
  public = list(
    `deploymentApprovalStatus` = NULL,
    `forecastDistance` = NULL,
    `forecastPoint` = NULL,
    `isOutlierPrediction` = NULL,
    `passthroughValues` = NULL,
    `prediction` = NULL,
    `predictionExplanations` = NULL,
    `predictionIntervals` = NULL,
    `predictionThreshold` = NULL,
    `predictionValues` = NULL,
    `rowId` = NULL,
    `seriesId` = NULL,
    `shapExplanationsMetadata` = NULL,
    `timestamp` = NULL,
    #' @description A function used to initialize an instance of this class.
    #' @param deploymentApprovalStatus The approval status of the deployment.
    #' @param forecastDistance In the case of time series project, the number of time units this row is away from the forecastPoint. The unit of time is determined by the timeUnit of the datetime partition column.
    #' @param forecastPoint For time series projects only. The time in the dataset relative to which predictions were generated.
    #' @param isOutlierPrediction The outlier warning check result.
    #' @param passthroughValues
    #' @param prediction In the case of a regression, the value predicted for the target in that row. In the case of any classification type, the class of the target which the row is predicted to belong to.
    #' @param predictionExplanations Array contains &#x60;predictionExplanation&#x60; objects. Will be present only if &#x60;explanationAlgorithm&#x60; is not null (prediction explanations were requested).
    #' @param predictionIntervals
    #' @param predictionThreshold Threshold used for binary classification in predictions.
    #' @param predictionValues Array of &#x60;predictionValue&#x60; objects for each class.
    #' @param rowId The row in the prediction dataset this prediction corresponds to.
    #' @param seriesId The ID of the series value for a multiseries project. For time series projects that are not multiseries this will be a null.
    #' @param shapExplanationsMetadata Array contains prediction explanation metadata.
    #' @param timestamp The timestamp of this row in the prediction dataset.
    #' @param validateParams An optional param for auto validating this object's parameters before initialization. Default FALSE.
    #' @param ... Any additional keyword arguments to be passed into this object for initialization.
    initialize = function(`prediction` = NULL, `predictionValues` = NULL, `rowId` = NULL, `deploymentApprovalStatus` = NULL, `forecastDistance` = NULL, `forecastPoint` = NULL, `isOutlierPrediction` = NULL, `passthroughValues` = NULL, `predictionExplanations` = NULL, `predictionIntervals` = NULL, `predictionThreshold` = NULL, `seriesId` = NULL, `shapExplanationsMetadata` = NULL, `timestamp` = NULL, validateParams = FALSE, ...) {
      local.optional.var <- list(...)
      if (validateParams) {
        lapply(list(`prediction`, `predictionValues`, `rowId`), function(param) {
          stopifnot("Required param not set." = !is.null(param))
        })
        private$validateProps(deploymentApprovalStatus, forecastDistance, forecastPoint, isOutlierPrediction, passthroughValues, prediction, predictionExplanations, predictionIntervals, predictionThreshold, predictionValues, rowId, seriesId, shapExplanationsMetadata, timestamp)
      }
      self$`deploymentApprovalStatus` <- .setPrimitiveProperty(typeList = list("character"), propertyData = deploymentApprovalStatus)
      self$`forecastDistance` <- `forecastDistance`
      self$`forecastPoint` <- `forecastPoint`
      self$`isOutlierPrediction` <- `isOutlierPrediction`
      self$`passthroughValues` <- `passthroughValues`
      self$`prediction` <- .setPrimitiveProperty(typeList = list("character", "numeric"), propertyData = prediction)
      self$`predictionExplanations` <- `predictionExplanations`
      self$`predictionIntervals` <- `predictionIntervals`
      self$`predictionThreshold` <- `predictionThreshold`
      self$`predictionValues` <- `predictionValues`
      self$`rowId` <- `rowId`
      self$`seriesId` <- `seriesId`
      self$`shapExplanationsMetadata` <- `shapExplanationsMetadata`
      self$`timestamp` <- `timestamp`
    },
    #' @description A helper function that provides public access to the private validateProps function. This allows users the ability
    #' to programmatically validate objects before sending them to DataRobot.
    #' checking this objects set properties.
    validate = function() {
      do.call(private$validateProps, list(deploymentApprovalStatus = self$`deploymentApprovalStatus`, forecastDistance = self$`forecastDistance`, forecastPoint = self$`forecastPoint`, isOutlierPrediction = self$`isOutlierPrediction`, passthroughValues = self$`passthroughValues`, prediction = self$`prediction`, predictionExplanations = self$`predictionExplanations`, predictionIntervals = self$`predictionIntervals`, predictionThreshold = self$`predictionThreshold`, predictionValues = self$`predictionValues`, rowId = self$`rowId`, seriesId = self$`seriesId`, shapExplanationsMetadata = self$`shapExplanationsMetadata`, timestamp = self$`timestamp`))
    },
    #' @description A helper function that serializes this object into a JSON encoded string.
    toJSON = function() {
      jsoncontent <- c(
        if (!is.null(self$`deploymentApprovalStatus`)) {
          sprintf(
            '"deploymentApprovalStatus":
            %s
      ',
            self$`deploymentApprovalStatus`
          )
        },
        if (!is.null(self$`forecastDistance`)) {
          sprintf(
            '"forecastDistance":
            %d
                  ',
            self$`forecastDistance`
          )
        },
        if (!is.null(self$`forecastPoint`)) {
          sprintf(
            '"forecastPoint":
            "%s"
                  ',
            format(self$`forecastPoint`, format = "%Y-%m-%dT%H:%M:%OSZ", tz = "UTC")
          )
        },
        if (!is.null(self$`isOutlierPrediction`)) {
          sprintf(
            '"isOutlierPrediction":
            %s
                  ',
            tolower(self$`isOutlierPrediction`)
          )
        },
        if (!is.null(self$`passthroughValues`)) {
          sprintf(
            '"passthroughValues":
            "%s"
                  ',
            self$`passthroughValues`
          )
        },
        if (!is.null(self$`prediction`)) {
          sprintf(
            '"prediction":
            %s
      ',
            self$`prediction`
          )
        },
        if (!is.null(self$`predictionExplanations`)) {
          sprintf(
            '"predictionExplanations":
            [%s]
      ',
            paste(sapply(self$`predictionExplanations`, function(x) jsonlite::toJSON(x$toJSON(), auto_unbox = TRUE, digits = NA)), collapse = ",")
          )
        },
        if (!is.null(self$`predictionIntervals`)) {
          sprintf(
            '"predictionIntervals":
            "%s"
                  ',
            self$`predictionIntervals`
          )
        },
        if (!is.null(self$`predictionThreshold`)) {
          sprintf(
            '"predictionThreshold":
            %d
                  ',
            self$`predictionThreshold`
          )
        },
        if (!is.null(self$`predictionValues`)) {
          sprintf(
            '"predictionValues":
            [%s]
      ',
            paste(sapply(self$`predictionValues`, function(x) jsonlite::toJSON(x$toJSON(), auto_unbox = TRUE, digits = NA)), collapse = ",")
          )
        },
        if (!is.null(self$`rowId`)) {
          sprintf(
            '"rowId":
            %d
                  ',
            self$`rowId`
          )
        },
        if (!is.null(self$`seriesId`)) {
          sprintf(
            '"seriesId":
            "%s"
                  ',
            self$`seriesId`
          )
        },
        if (!is.null(self$`shapExplanationsMetadata`)) {
          sprintf(
            '"shapExplanationsMetadata":
            [%s]
      ',
            paste(sapply(self$`shapExplanationsMetadata`, function(x) jsonlite::toJSON(x$toJSON(), auto_unbox = TRUE, digits = NA)), collapse = ",")
          )
        },
        if (!is.null(self$`timestamp`)) {
          sprintf(
            '"timestamp":
            "%s"
                  ',
            format(self$`timestamp`, format = "%Y-%m-%dT%H:%M:%OSZ", tz = "UTC")
          )
        }
      )
      jsoncontent <- paste(jsoncontent, collapse = ",")
      paste("{", jsoncontent, "}", sep = "")
    },
    #' @description A helper function that deserializes a JSON string into an instance of this class.
    #' @param PredictionProxyDataJson A JSON encoded string representation of a class instance.
    #' @param validateParams An optional param for auto validating this object's parameters after deserialization. Default FALSE.
    fromJSON = function(PredictionProxyDataJson, validateParams = FALSE) {
      PredictionProxyDataObject <- jsonlite::fromJSON(PredictionProxyDataJson)
      self$`deploymentApprovalStatus` <- .setPrimitiveProperty(typeList = list("character"), propertyData = PredictionProxyDataObject$deploymentApprovalStatus)
      self$`forecastDistance` <- PredictionProxyDataObject$`forecastDistance`
      self$`forecastPoint` <- ParseRFC3339Timestamp(PredictionProxyDataObject$`forecastPoint`)
      self$`isOutlierPrediction` <- PredictionProxyDataObject$`isOutlierPrediction`
      self$`passthroughValues` <- PredictionProxyDataObject$`passthroughValues`
      self$`prediction` <- .setPrimitiveProperty(typeList = list("character", "numeric"), propertyData = PredictionProxyDataObject$prediction)
      self$`predictionExplanations` <- ApiClient$new()$deserializeObj(PredictionProxyDataObject$`predictionExplanations`, "array[PredictionExplanationsValues]", loadNamespace("datarobot.apicore"))
      self$`predictionIntervals` <- PredictionProxyDataObject$`predictionIntervals`
      self$`predictionThreshold` <- PredictionProxyDataObject$`predictionThreshold`
      self$`predictionValues` <- ApiClient$new()$deserializeObj(PredictionProxyDataObject$`predictionValues`, "array[PredictionValues]", loadNamespace("datarobot.apicore"))
      self$`rowId` <- PredictionProxyDataObject$`rowId`
      self$`seriesId` <- PredictionProxyDataObject$`seriesId`
      self$`shapExplanationsMetadata` <- ApiClient$new()$deserializeObj(PredictionProxyDataObject$`shapExplanationsMetadata`, "array[ShapExplanationsMetadataValues]", loadNamespace("datarobot.apicore"))
      self$`timestamp` <- ParseRFC3339Timestamp(PredictionProxyDataObject$`timestamp`)

      if (validateParams) {
        self$validate()
      }

      return(self)
    }
  )
)
